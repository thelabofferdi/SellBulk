
---

# ğŸ“• PRD â€” SELLIFY BACKEND (TAURI)

**Version : 1.0**
**Statut : final â€“ prÃªt implÃ©mentation**
**PortÃ©e : backend local uniquement (Rust + Tauri)**

---

## 0. Philosophie produit (fondation)

### Principe fondamental

> **Sellify est un moteur dÃ©terministe.**
> Lâ€™IA nâ€™est quâ€™un **outil de gÃ©nÃ©ration de texte**, jamais un dÃ©cideur.

### ConsÃ©quences techniques

* aucune logique mÃ©tier dans lâ€™IA
* aucune dÃ©cision laissÃ©e au hasard
* toute action est traÃ§able, explicable, reproductible
* toute dÃ©rive est bloquÃ©e **avant** lâ€™envoi WhatsApp

---

## 1. Contraintes globales (NON nÃ©gociables)

1. Mono WhatsApp par machine
2. Mono licence par HWID
3. Fonctionnement offline-first
4. IA stateless
5. Aucun message client ne mentionne :

   * IA
   * humain
   * escalade
6. Toute action appartient Ã  un ensemble fini
7. ZÃ©ro autonomie IA

---

## 2. Architecture logique du backend

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚      Tauri Backend       â”‚
â”‚          (Rust)          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ License Engine           â”‚
â”‚ Storage Engine           â”‚
â”‚ Config Engine            â”‚
â”‚ Knowledge Base Engine    â”‚
â”‚ Conversation Engine      â”‚
â”‚ Decision Engine (CORE)   â”‚
â”‚ Quota & Anti-Ban Engine  â”‚
â”‚ IA Gateway               â”‚
â”‚ WhatsApp Gateway         â”‚
â”‚ Alert Engine             â”‚
â”‚ Audit & Safety Engine    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## 3. License Engine

### RÃ´le

* autoriser ou bloquer lâ€™exÃ©cution
* fournir les clÃ©s sensibles au runtime

### DonnÃ©es gÃ©rÃ©es

* HWID
* clÃ© dâ€™activation
* API key IA
* date dâ€™expiration
* type de licence

### RÃ¨gles

* licence stockÃ©e chiffrÃ©e localement
* HWID vÃ©rifiÃ© Ã  chaque dÃ©marrage
* invalidation immÃ©diate si incohÃ©rence
* aucune clÃ© exposÃ©e au frontend

### Ã‰tats possibles

```
VALID
INVALID
EXPIRED
HWID_MISMATCH
TAMPERED
```

---

## 4. Storage Engine

### RÃ´le

Stockage local **chiffrÃ©** et transactionnel.

### Contenu stockÃ©

* conversations
* Ã©tats de conversation
* base de connaissance
* quotas
* logs IA
* audit
* configuration

### Contraintes

* aucune dÃ©pendance cloud
* lecture/Ã©criture atomique
* corruption dÃ©tectable

---

## 5. Config Engine

### RÃ´le

Centraliser **tous les paramÃ¨tres globaux**.

### ParamÃ¨tres obligatoires

* horaires actifs
* dÃ©lais min / max de rÃ©ponse
* activation IA
* numÃ©ros WhatsApp dâ€™alerte
* stratÃ©gie anti-ban
* seuils dâ€™escalade

### RÃ¨gle

> Le Decision Engine ne lit **que** le Config Engine.

---

## 6. Knowledge Base Engine

### RÃ´le

DÃ©finir **lâ€™univers autorisÃ©** de lâ€™IA.

### Structure PRODUIT (canonique)

```json
Product {
  id: UUID
  name: string
  short_description: string
  long_description: string
  price: string
  keywords: string[]
  objections: {
    trigger: string
    answer: string
  }[]
  media: {
    images: FileRef[]
    video: FileRef | null
  }
  media_policy: {
    allow_images: boolean
    allow_video: boolean
  }
}
```

### RÃ¨gles

* aucun produit non listÃ© ne peut Ãªtre mentionnÃ©
* aucun mÃ©dia non attachÃ© ne peut Ãªtre envoyÃ©
* lâ€™IA ne â€œvoitâ€ que ce contenu

---

## 7. Conversation Engine

### RÃ´le

Maintenir lâ€™Ã©tat **objectif** dâ€™une discussion.

### Ã‰tats autorisÃ©s

```rust
enum ConversationState {
  Discovery,
  Interest,
  Intent,
  Objection,
  Negative,
  Escalated,
  Frozen
}
```

### Transitions

* dÃ©terministes
* basÃ©es sur rÃ¨gles + signaux
* jamais dÃ©cidÃ©es par lâ€™IA

---

## 8. Quota & Anti-Ban Engine

### RÃ´le

EmpÃªcher tout comportement dÃ©tectable comme automatisÃ©.

### Quotas gÃ©rÃ©s

* messages / jour
* messages / semaine
* images / jour
* vidÃ©os / semaine

### DÃ©lais

* dÃ©lai minimum entre rÃ©ponses
* dÃ©lai allongÃ© aprÃ¨s mÃ©dia
* jitter alÃ©atoire contrÃ´lÃ©

### Comportement

* rÃ©duction progressive avant limite
* blocage dur Ã  dÃ©passement
* aucune exception

---

## 9. Decision Engine (CÅ’UR DU SYSTÃˆME)

### RÃ´le

DÃ©cider **quoi faire**, jamais comment lâ€™IA parle.

### Inputs

* message entrant
* Ã©tat conversation
* quotas
* rÃ¨gles
* horaires
* base de connaissance

### Actions possibles (fermÃ©es)

```rust
enum Action {
  RespondText,
  RespondWithMedia,
  Ignore,
  Delay,
  AlertHuman,
  StopAutomation
}
```

### Interdictions

* aucune autre action possible
* aucune improvisation
* aucune ambiguÃ¯tÃ©

---

## 10. Alert Engine (intervention humaine)

### RÃ´le

Notifier un humain **sans jamais le rÃ©vÃ©ler au client**.

### DÃ©clencheurs

* colÃ¨re
* menace
* incomprÃ©hension rÃ©pÃ©tÃ©e
* mots sensibles
* situation lÃ©gale

### Action

* envoi WhatsApp vers numÃ©ro interne

Exemple :

```
ğŸš¨ Intervention requise
Client : +33XXXX
Ã‰tat : Objection
Dernier message : "..."
```

### Effet client

* aucune mention
* silence ou rÃ©ponse neutre

---

## 11. IA Gateway

### RÃ´le

GÃ©nÃ©rer **du texte uniquement**, sous contrainte.

### Lâ€™IA NE PEUT PAS

* dÃ©cider
* poser des questions libres
* proposer contact humain
* inventer des infos
* envoyer mÃ©dia

### Prompt toujours gÃ©nÃ©rÃ© par backend

* objectif unique
* longueur max
* ton imposÃ©
* interdictions explicites

---

## 12. Anti-Hallucination (double verrou)

### Avant IA

* validation produit
* validation action
* validation quota

### AprÃ¨s IA

* filtrage lexical
* longueur
* mots interdits
* promesses commerciales

En cas dâ€™Ã©chec :

* message rejetÃ©
* fallback neutre

---

## 13. WhatsApp Gateway

### RÃ´le

Interface purement technique.

### AutorisÃ©

* recevoir messages
* envoyer texte
* envoyer mÃ©dia
* QR code

### Interdit

* logique mÃ©tier
* rÃ¨gles
* dÃ©cisions

---

## 14. Audit & Safety Engine

### RÃ´le

TraÃ§abilitÃ© complÃ¨te.

### Journalisation

Pour chaque message :

* message entrant
* Ã©tat
* action choisie
* prompt IA
* rÃ©ponse IA
* message envoyÃ©
* quotas avant/aprÃ¨s

---

## 15. Cas limites gÃ©rÃ©s (obligatoires)

* IA indisponible
* quota atteint
* licence expirÃ©e
* WhatsApp dÃ©connectÃ©
* mÃ©dia manquant
* message incomprÃ©hensible

Dans tous les cas :

> **Le systÃ¨me se tait plutÃ´t que de risquer.**

---

## 16. Ordre dâ€™implÃ©mentation recommandÃ©

1. License Engine
2. Storage Engine
3. Config Engine
4. Knowledge Base Engine
5. Conversation Engine
6. Quota Engine
7. Decision Engine
8. Alert Engine
9. IA Gateway
10. WhatsApp Gateway
11. Audit Engine

---

## 17. Definition of Done (backend)

âœ” aucune dÃ©cision IA
âœ” aucun hallucination produit
âœ” aucune mention humaine client
âœ” quotas stricts respectÃ©s
âœ” audit complet
âœ” backend testable sans UI

---

## Conclusion

Avec ce backend :

* tu contrÃ´les **100 % du comportement**
* lâ€™IA est **inoffensive par construction**
* Sellify se comporte comme **un vrai agent humain prudent**
* tu rÃ©duis **au maximum** les risques WhatsApp

---


